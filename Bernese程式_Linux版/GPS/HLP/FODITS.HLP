<html>
<body>

<center>
<b>ANALYSIS OF TIME SERIES</b>
<p>Program: FODITS
</center>
<hr width="100%">

<a name="ENVIRONMENT"   default="%% %%"></a>
<a name="CAMPAIGN"      default=""></a>
<a name="SESSION_TABLE" default="SESSIONS"></a>
<a name="YR4_INFO"      default="$Y+0"></a>
<a name="SES_INFO"      default="$S+0"></a>
<a name="USR_INFO"      default="${USER}"></a>
<a name="STALST"        default=""></a>
<a name="OUT_FILE_VERBOSET"  default="0"></a>
<a name="OUT_FILE_VERBOSETT" default="0"></a>

<p><b>GENERAL DESCRIPTION</b></p>
<p>
FODITS is a tool to analyze time series.
The input and output interfaces have been designed to analyze coordinate time
series from and for the program <a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a>. Other
kinds of time series may be analyzed if they are converted into the appropriate
format.
<br>
The station coordinates are analyzed in the North-oriented local frame
(with components North, East, and Up).
A functional model is adapted to the time series <nobr>step-by-step</nobr>.
The elements of this functional model are discontinuities, outliers,
velocity changes, and periodic functions.
These elements might either be identified during the analysis of the time-series
or be derived from lists of predefined events.
The following lists can be processed:
<ul>
<li>user-defined events (<a href="/$X/DOC/EXAMPLE.EVL">EVL</a>),
<li>the history of equipment changes in the station information file
(<a href="/$X/DOC/EXAMPLE.STA">STA</a>), or
<li>a list of earthquakes (<a href="/$X/DOC/EXAMPLE.ERQ">ERQ</a>),
as provided by the U.S. Geological Survey (USGS).
</ul>
In addition further elements like, e.g., annual signals may be proposed on panel 4.
<p>
First all predefined elements are tested for their significance. This screening
procedure is performed <nobr>step-by-step</nobr>, where in each step the element
leading to the most significant improvement is added to the model (as long as the
improvement surpasses a certain threshold). In the following iteration step
additional elements are searched by the program. If such elements are found,
the algorithm returns to the screening loop. Elements that were tested
insignificant (below threshold) in a prior screening loop are tested again,
together with the new elements. If no new element is found, the algorithm stops.
<br>
From the results of this analysis the following metadata files are updated to
allow for a more consistent <a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a> solution:
<ul>
<li>the station information file (<a href="/$X/DOC/EXAMPLE.STA">STA</a>),
<li>the list of reference sites (<a href="/$X/DOC/EXAMPLE.FIX">FIX</a>), and
<li>the coordinate set (<a href="/$X/DOC/EXAMPLE.CRD">CRD</a>,
<a href="/$X/DOC/EXAMPLE.VEL">VEL</a>).
</ul>

<p><hr>

<p><b>FODITS 1: Input Files</b>

<a name="SHOWGEN" default="1"></a>
<p><b>GENERAL FILES</b>
<p><b>Show all general files:</b>
Check this box to have a list of the general input files used by FODITS.

<a name="SHOWVAR" default="1"></a>
<p><b>Show all general variables:</b>
General variables related to the program FODITS may be checked and modified.

<br><br>

<a name="SEL_INP_TS_TYPE" default="RESIDUALS"></a>
<p><b>INPUT FILES</b>
<p><b>Select input format for the time series:</b>
<ul>
<li><b>RESIDUALS:</b>
     the time series are read from the
     <a href="/$X/DOC/EXAMPLE.PLT">PLT</a> file.
<li><b>COORDINATES:</b>
     the time series are read from series of
     <a href="/$X/DOC/EXAMPLE.CRD">CRD</a> files.
</ul>

<a name="IN_PLT_FILE" default=""></a>
<p><b>ADDNEQ2 plot file with residuals:</b>
The <a href="/$X/DOC/EXAMPLE.PLT">PLT</a> file
is usually generated by <a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a>.
Alternatively, one may convert any time series to the format of the
ADDNEQ2 plot file.
Each line must contain (from left to right):
<ul>
<li>station name,
<li>epoch counter
<li>component number (1=North, 2=East, 3=Up),
<li>residual, and
<li>epoch [Modified Julian Date].
</ul>
The station name is read with fixed format (A16), all other
columns with free format (two integers, followed by 2 to 5 real numbers) .
<br>
Additionally, each line may further contain:
<ul>
<li>standard deviation (<tt>rmsN,rmsE,rmsU</tt> for component number 1,2,3
    resp.),
<li>correlation (<tt>corNE,corNU,corEU</tt> for component number 1,2,3 resp.),
    and
<li>normalized RMS (not used by FODITS).
</ul>
From these values the variance-covariance matrix is computed:
<br>
<pre>
 [ covNN covNE covNU ]    1      [ rmsN**2 corNE*rmsN*rmsU corNU*rmsN*rmsU ]
 |       covEE covEU ] = ----- * [         rmsE**2         corEU*rmsE*rmsU ]
 [             covUU ]   m0**2   [                         rmsU**2         ]
</pre>
The <a href="#IN_PLT_FILE_VI_M0">a priori sigma of unit weight</a> m0
has to be defined by the user.

<p>Example: <a href="/$X/DOC/EXAMPLE.PLT">PLT</a>

<p><a name="IN_PLT_FILE_VCI_ENA" default="NONE"></a>
<b>Variance-covariance information:</b>
<ul>
<li><b>NONE:</b>
    neither standard deviation nor variance-covariance information are used.
<li><b>STDDEV_ONLY:</b>
    the standard deviation is used.
<li><b>SPACE_VARCOV:</b>
    the full variance-covariance information used.
</ul>

<p><i>Remark:</i>
<b>STDDEV_ONLY</b> or <b>SPACE_VARCOV</b> can only be selected if the
<a href="/$X/DOC/EXAMPLE.PLT">PLT</a> file contains the corresponding columns.

<p><i>Default value:</i> <tt>SPACE_VARCOV</tt>

<a name="IN_PLT_FILE_VI_M0" default="0.001"></a>
<p><b>A priori sigma of unit weight:</b>
m0 is needed for the stochastic model. It  must be given in the same units
as the residuals.

<p><i>Default value:</i> <tt>0.001 meter</tt>

<p><a name="IN_CRD_FILE" default=""></a>
<b>ADDNEQ2 coordinates file:</b>
Output file of station coordinates from
<a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a>,
consistent with the PLT file (of residuals) and
the VEL file (of station velocities).

<p>Example: <a href="/$X/DOC/EXAMPLE.CRD">CRD</a>

<p><a name="IN_VEL_FILE" default=""></a>
<b>ADDNEQ2 velocities file:</b>
Output file of station velocities from <a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a>,
consistent with the PLT file (of residuals) and
the CRD file (of station coordinates).

<p>Example: <a href="/$X/DOC/EXAMPLE.VEL">VEL</a>

<p><a name="IN_CRD_FILES" default=""></a>
<b>Coordinate files:</b>
Alternatively a series of Bernese coordinate files (CRDs) might be given.
They are interpreted as time series of station coordinates.

<p>Example: <a href="/$X/DOC/EXAMPLE.CRD">CRD</a>

<br><br>
<p><b>PREDEFINED EVENTS</b>
<p><a name="IN_EVL_FILE" default=""></a>
<b>Time series event list:</b>
This file allows it to set up
<ul>
<li>predefined discontinuities (DISC),
<li>velocity changes (VELO),
<li>outliers (OUTL), or
<li>periodic functions (PERI)
</ul>
in the functional model.
The associated flag to each entry determines whether the
parameter should be tested for significance (TST) or not (SET).
The flag (NOT) disables a parameter for the corresponding time interval.
The flag (EST) identifies entries that were found by FODITS
(usually only present in EVL output files).

<p><i>Remark:</i>
The use of an EVL file is optional.

<p>Example: <a href="/$X/DOC/EXAMPLE.EVL">EVL</a>

<p><a name="IN_STA_FILE" default=""></a>
<b>Station information file:</b>
This file contains information on station problems.
Equipment changes may cause discontinuities in coordinate time series.
Changes in station name, receiver type, receiver number,
antenna type, antenna number, and antenna eccentricity
are considered by FODITS, if the according options are set in
panel 3.

<p><i>Remark:</i>
The use of a STA file is optional.

<p>Example: <a href="/$X/DOC/EXAMPLE.STA">STA</a>

<p><a name="IN_ERQ_FILE" default="LIST.ERQ"></a>
<b>Earthquakes information file:</b>
A list of earthquakes containing information on epoch, epicenter, and
magnitude from the U.S.Geological Survey (USGS) earthquake data base is
read. At the corresponding epochs discontinuities and velocity changes
are tested for significance.

<p><i>Remark:</i>
The use of an ERQ file is optional.

<p><a href="/$X/DOC/EXAMPLE.ERQ">Example</a>

<p><hr>

<p><b>FODITS 1.1: General Files</b>

<p><b>GENERAL INPUT FILES</b>
<p><a name="CONST" default="CONST."></a>
<b>General constants:</b>
This file contains all the physical and astronomical constants used in the
Bernese Software. Most probably you will never have to modify this file.

<p>Example: <a href="/$X/GEN/CONST.">CONST.</a>

<p><a name="DATUM" default="DATUM."></a>
<b>Geodetic datum:</b>
This file contains the definition of the geodetic datum and of the ellipsoid
to be used to compute ellipsoidal coordinates. It is used to apply antenna
heights and for the printing of coordinates in the local system (north, east,
up). You only have to modify this file when you want to introduce a new
reference ellipsoid.

<p><i>Caution:</i>
This file has no effect on Cartesian coordinates.

<p>Example: <a href="/$X/GEN/DATUM.">DATUM.</a>

<br><br>
<p><b>TEMPORARY FILES</b><p>
<p><a name="AUXFIL" default="FODITS$J"></a>
<b>Scratch file:</b>
Enter the name of the scratch file used by this program. The scratch files
need to be named differently for different programs running simultaneously.
This may be achieved, e.g., by adding the job ID <tt>$J</tt> to the program
name (define the job ID in the dialog
<a href="SETDATE.HLP">Menu &gt; Configure &gt; Set session/compute day</a>).

<p><i>Default value:</i> <tt>FODITS$J</tt>

<p><hr>

<a name="GVAR_ERQ_FACT_A" default="-5.60"></a>
<a name="GVAR_ERQ_FACT_B" default="+2.17"></a>
<a name="GVAR_ERQ_MIN_DIST" default="60"></a>
<p><b>FODITS 1.2: General Variables</b>

<p><b>PARAMETERS FOR THE SELECTION OF RELEVANT EARTHQUAKES</b>
<p>
FODITS selects a list of relevant earthquakes for each station.
The criterion for selection reads
<pre>
 M<sub>erq</sub> &gt; M<sub>synthetic,erq</sub>
</pre>
where <tt>M<sub>erq</sub></tt> is the magnitude of the earthquake at the
epicenter and <tt>M<sub>synthetic,erq</sub>=A+B*log10(d<sub>erq</sub>)</tt> is
a threshold dependant on the distance <tt>d<sub>erq</sub></tt> of the station
from the epicenter (in meters).
For all relevant earthquakes a discontinuity and a velocity change are tested
for significance.

<p><b>Earthquake factor A:</b>
Empirical bias for the size of the threshold magnitude.

<p><i>Default value:</i> <tt>A=-5.60</tt>

<p><b>Earthquake factor B:</b>
Empirical factor for the damping of the magnitude with distance from the epicenter.

<p><i>Default value:</i> <tt>B=+2.17</tt>

<p><i>Remark:</i>
With the default values for <tt>A</tt> and <tt>B</tt> a magnitude 5 earthquake is
considered up to a distance of 77 km from the epicenter, a magnitude 6
earthquake up to 222 km, a magnitude 7 earthquake up to 640 km, etc.

<p><b>Minimal time span between quakes (days):</b>
Large earthquakes are usually followed by many aftershocks within short time.
All aftershocks following the main (largest) earthquake within this 'minimal
time span between quakes' are neglected.

<p><i>Default value:</i> <tt>60</tt>

<br><br>

<a name="IN_CRD_FILE_ADD_PLT" default="1"></a>
<a name="IN_VEL_FILE_ADD_PLT" default="1"></a>
<p><b>TIME SERIES OF STATION COORDINATES</b>
<p>FODITS is most commonly used to analyze time series of station coordinates
estimated by <a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a>. The Output of ADDNEQ2
consists of coordinates (<a href="/$X/DOC/EXAMPLE.CRD">CRD</a>), velocities
(<a href="/$X/DOC/EXAMPLE.VEL">VEL</a>) and residuals
(<a href="/$X/DOC/EXAMPLE.PLT">PLT</a>). While in
principle an analysis of the residuals is suitable to find discontinuities in
the time series, it is recommended to always reconstruct and analyze the
complete coordinate time series (CRD + (t - t<sub>0</sub>) * VEL + residuals).
If the time series is concatenated from different segments (separated prior
by station renaming in the STA-file), this step is mandatory.
<p><b>Add coordinates:</b>
If this box is checked (and if a <a href="/$X/DOC/EXAMPLE.CRD">CRD</a> file is
given on panel 1), the station coordinates are added back to the time series
of residuals in the <a href="/$X/DOC/EXAMPLE.PLT">PLT</a> file.

<p><i>Warning:</i> To properly reconstruct station coordinate time series from
CRD and residuals, the CRD must originate directly from ADDNEQ2 and not from a
subsequent Helmert transformation.

<p><i>Default value:</i> marked

<p><b>Add velocities:</b>
If this box is checked (and if a <a href="/$X/DOC/EXAMPLE.VEL">VEL</a> file
is given on panel 1), the velocities are added back to the time series of
residuals in the <a href="/$X/DOC/EXAMPLE.PLT">PLT</a> file.

<p><i>Remark:</i> The reconstruction of station coordinate time series
is mandatory, if a Helmert transformation shall be performed to test
the datum for outliers (panels 4 and 4.1).

<p><i>Default value:</i> marked

<br><br>

<a name="GVAR_MAX_NR_ITER"default="20"></a>
<a name="GVAR_MAX_NR_SCRN"default="50"></a>
<p><b>ALGORITHM PARAMETERS</b>
<p><b>Maximal number of iteration steps:</b>
Limits the number of iteration steps.

<p><i>Default value:</i> <tt>20</tt>

<p><b>Maximal number of screening steps:</b>
Limits the number of screening steps.

<p><i>Default value:</i> <tt>50</tt>

<br><br>

<a name="MOD_N_NEW_OUTL" default="20"></a>
<a name="MOD_N_OUTL_RMS" default="100"></a>
<p><b>NEW ELEMENTS</b>
<p><b>Maximal number of outliers per iteration:</b>
Outliers are treated separately from discontinuities,
velocity changes, and periodic function parameters. This value defines the
maximal number of significant outliers that may be added to the functional
model in a single iteration step.

<p><i>Default value:</i> <tt>20</tt>

<p><b>Overall threshold for outlier detection:</b>
Coordinates larger than this factor times the a posteriori RMS are automatically
classified as outliers.

<p><i>Default value:</i> <tt>100</tt>

<p><hr>

<p><b>FODITS 2: Output Files</b>

<a name="OUT_EVL_FILE" default=""></a>
<a name="OUT_STA_FILE_FOR_ADDNEQ2" default=""></a>
<p><b>RESULT FILES</b>
<p><b>Time series event list:</b>
This file reports all discontinuities (DISC), velocity changes (VELO),
outliers (OUTL), and periodic functions (PERI) that were tested significant
by FODITS. Newly found elements are reported with flag TST. This output
EVL file may be modified by the user and reused as input for a subsequent
FODITS analysis.

<p><i>Remark:</i>
The output of an EVL file is optional.

<p>Example: <a href="/$X/DOC/EXAMPLE.EVL">EVL</a>

<p><b>Station information file:</b>
This file is updated with the results of the time series analysis by FODITS
and may be used for a subsequent, more consistent,
<a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a> solution. The following entries are
modified:
<ul>
<li>TYPE 001: At discontinuities the characters 15 and 16 of the station
    name are changed (... ZX, ZY, ZZ, __
    (<a href="#OUT_TIMREF">reference epoch</a>), AA, AB, AC ...)
    to force ADDNEQ2 to generate separate solutions for this station before
    and after the discontinuity.
<li>TYPE 003: Outliers detected by FODITS are reported epoch-by-epoch to
    enable pre-elimination by ADDNEQ2.
<li>TYPE 004: Discontinuities caused by equipment changes (and marked by
    station renaming in TYPE 001) do not lead to changes in the station
    velocities. Therefore relative constraints are set (tight constraints
    (sigma of 0.00001) for velocities, loose constraints (sigma of 99.99999)
    for coordinates).
</ul>

<p><i>Remark:</i>
FODITS panel 7 is activated, whenever this option is set.

<p>Example: <a href="/$X/DOC/EXAMPLE.STA">STA</a>

<br><br>

<a name="OUT_PLT_FILE" default=""></a>
<p><b>OUTPUT FILES</b>
<p><b>Plot file with residuals:</b>
Time series of residuals with respect to the FODITS final functional model
are stored in this PLT file.

<p><i>Remark:</i>
The output of a PLT file is optional.

<p>Example: <a href="/$X/DOC/EXAMPLE.PLT">PLT</a>

<br><br>

<a name="OUT_FILE_VERBOSE" default="0"></a>
<b>GENERAL OUTPUT FILES</b>
<p><b>Verbose mode:</b>
If this option is selected, the intermediate results of the FODITS procedure
as well as the resulting time series of the analyzed coordinates and the
resulting tabular values of the functional model are reported in the program
output file.

<p><i>Remark:</i>
Be careful with this option, the output file may become very large.

<p><a name="SYSODEF" default="1"></a>
   <a name="SYSOUT" default="FODITS"></a>
<b>Program output:</b>
You can choose to have the program output written to a separate file for each
program run (checkbox marked), or specify a common name for all program runs.
If you mark the checkbox, the filename will correspond to the program name
with an extension containing a counter (Lnn), which is automatically
incremented for each program run. If the counter reaches the maximum value,
it is automatically reset, and existing files will be overwritten. The maximum
value can be set in <b>Menu &gt; Configure &gt; Program Names</b>, option
"Maximum program output file number".
<br>
If the checkbox is unmarked, you have to specify a name for the program
output file. This allows to characterize the program run, e.g., by using the
day and year (<tt>$YD+0</tt>) in the filename.

<a name="ERRMRG" default="0"></a>
<a name="SYSERR" default="ERROR"></a>
<p><b>Error messages:</b>
You can choose to have error messages written into the program's output
file (see above), or specify a separate file to which error messages are
written.

<p><hr>

<p><b>FODITS 3: Handling of information coming from the input files</b>

<p><a name="TITLE" default=""></a>
<b>TITLE</b>
<p>
This title line will be printed as header comment in the program output and
will be saved in all the result files to document the program run. The title
should characterize the program run by, e.g., giving the most important
options used and the session.

<br><br>

<a name="IN_TRUNC_STA_NAME" default="YES"></a>
<a name="IN_MAN_STA" default=""></a>
<a name="IN_MIN_NR_OBS" default="20"></a>
<p><b>INPUT STATION NAMES</b>
<p><b>Truncate all station names after position 14:</b>
Station names are 16 characters long. This editable combobox defines whether
station names are:
<ul>
<li>truncated after character 14 (<b>YES</b>),
<li>not truncated (<b>NO</b>),
<li>truncated after <tt>n</tt> characters (where <tt>n=1...15</tt> is read
from the combobox).
</ul>
One may truncate station names, e.g., after character 14, to recollect the
time series of renamed stations into one unique time series.

<p><i>Default value:</i> <tt>YES</tt>

<p><b>Manual station selection (blank=all):</b>
Push the button next to the field in order to get a list of stations
involved in the solution (as extracted from the PLT-file, the CRD-files, or
from an external file - depending on the selected input file(s)). Select
the stations by highlighting them.

<p><i>Default value:</i> blank

<p><b>Minimal number of observations per station:</b>
Time series with less than the minimal number of observations are not analyzed
by FODITS. If left blank all stations will be analyzed.

<p><i>Default value:</i> <tt>20</tt>

<br><br>

<a name="TST_EVL_TST" default="TEST"></a>
<p><b>SELECTION AND HANDLING OF EVENTS</b>
<p><b>Previously tested events:</b>
Concerns events that were tested significant by a previous FODITS run and
added to the <a href="/$X/DOC/EXAMPLE.EVL">EVL</a> file with flag EST:
<b>NONE</b> = do not test again, <b>TEST</b> = test again for significance,
<b>INSR</b> = insert permanently into the functional model.

<p><i>Default value:</i> <tt>TEST</tt>

<a name="TST_STA_RENAMINGS"      default="INSR">
<a name="TST_REC_TYPE_CHANGES"   default="TEST">
<a name="TST_REC_NUMBER_CHANGES" default="TEST">
<a name="TST_ANT_NAME_CHANGES"   default="TEST">
<a name="TST_ANT_TYPE_CHANGES"   default="TEST">
<a name="TST_ECC_CHANGES"        default="TEST">
<p><b>Events from station information file:</b>
The station information file (<a href="/$X/DOC/EXAMPLE.STA">STA</a>)
contains the history of equipment changes. These changes may be introduced
to FODITS as discontinuities with the following attributes:
<b>NONE</b> = do not test (ignore), <b>TEST</b> = test for significance,
<b>INSR</b> = insert discontinuity permanently into the functional model.
<ul>
<li><b>Station renaming (TYPE 001): </b><i>Default value:</i> <tt>INSR</tt>
<li><b>Receiver type changes (TYPE 002): </b><i>Default value:</i> <tt>NONE</tt>
<li><b>Receiver number changes (TYPE 002): </b><i>Default value:</i> <tt>NONE</tt>
<li><b>Antenna type changes (TYPE 002): </b><i>Default value:</i> <tt>TEST</tt>
<li><b>Antenna number changes (TYPE 002): </b><i>Default value:</i> <tt>TEST</tt>
<li><b>Antenna eccentricities (TYPE 002): </b><i>Default value:</i> <tt>TEST</tt>
</ul>

<p><hr>

<p><b>FODITS 4: Model definition</b>

<a name="MOD_PRE_DAT_TEST" default="0"></a>
<p><b>PRE-ANALYSIS STEP</b>
<p><b>Test datum definition:</b>
Enable panel 4.1 for a test of the datum definition.

<p><i>Default value:</i> Unmarked

<br><br>

<a name="MIN_TIME_INT_VEL" default="2.5"></a>
<p><b>VELOCITY CHANGES</b>
<p><b>Minimal interval length for all rate intervals:</b>
Before new velocity changes are added in the functional model the algorithm
tests whether the remaining intervals (before and after the epoch of the new
velocity change) meet this criterion.

<p><i>Default value:</i> <tt>2.5 years</tt>

<br><br>

<a name="MOD_PER_ANN" default="1"></a>
<a name="MOD_ADD_ENA" default="0"></a>
<a name="MOD_ADD_PER_PARAM" default=""></a>
<p><b>PERIODIC FUNCTIONS</b>
<p><b>Propose seasonal signals:</b>
Time series of station coordinates may be affected by seasonal
periodic variations. With this option an annual signal and a semi-annual
signal are proposed for the significance test.

<p><i>Default value:</i> marked

<p><b>Propose additional periods:</b>
The user may define periodic signals of arbitrary periods to be tested for
significance.

<p><i>Default value:</i> unmarked

<p><hr>

<p><b>FODITS 4.1: Test datum definition by Helmert transformation</b>

<a name="IN_DATUM_CRD_FILE" default=""></a>
<a name="IN_DATUM_VEL_FILE" default=""></a>
<a name="IN_DATUM_FIX_FILE" default=""></a>
<p><b>REFERENCE DATUM</b>
<p><b>Reference ADDNEQ2 coordinates file:</b>
File of reference coordinates for the Helmert transformation. Usually, this
file corresponds to the file of coordinates provided by
<a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a> as stacked solution.

<p>Example: <a href="/$X/DOC/EXAMPLE.CRD">CRD</a>

<p><b>Reference ADDNEQ2 velocities file:</b>
File of reference velocities for the Helmert transformation. Usually, this
file corresponds to the file of velocities provided by
<a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a> as stacked solution.

<p>Example: <a href="/$X/DOC/EXAMPLE.VEL">VEL</a>

<p><b>ADDNEQ2 fiducial stations file:</b>
List of reference sites for the Helmert transformation. Usually, this file
corresponds to the list of fiducial sites used for the original
<a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a> stacked solution.

<p>Example: <a href="/$X/DOC/EXAMPLE.FIX">FIX</a>

<br><br>

<a name="HLM_1" default="1"></a>
<a name="HLM_2" default="1"></a>
<a name="HLM_3" default="1"></a>
<a name="HLM_4" default="0"></a>
<a name="HLM_5" default="0"></a>
<a name="HLM_6" default="0"></a>
<a name="HLM_7" default="1"></a>
<p><b>HELMERT TRANSFORMATION</b>
<p><b>Parameters to be estimated:</b>
Select the parameters of the Helmert transformation. Up to
3&nbsp;translations, 3&nbsp;rotations, and a scale may be specified.
If no parameters are selected, only the differences between the two
coordinate sets are computed.

<p><i>Default value:</i> Translations: marked, rotations: unmarked,
scale: marked

<br><br>

<a name="DAT_REJECT_CRD" default="0"></a>
<a name="DAT_NLIMIT_CRD" default="50"></a>
<a name="DAT_ELIMIT_CRD" default="50"></a>
<a name="DAT_ULIMIT_CRD" default="50"></a>
<a name="DAT_REJECT_OUTL_CRD" default="TEST"></a>
<p><b>OUTLIER REJECTION FOR STATION COORDINATES</b>
<p><b>Enable outlier rejection:</b>
The datum definition is tested via Helmert transformation for each epoch
of the station coordinates time series. If the differences between
station coordinates and the corresponding reference coordinates
surpass certain thresholds (defined below), the station is marked as
an outlier.

<p><i>Default value:</i> unmarked

<p><b>Threshold for rejection:</b>
Specify here the thresholds for the rejection of outliers for all three
components north, east, and up individually. When at least one component
surpasses its threshold, the station is marked as outlier. The reference
site with the largest outlier (if any) is rejected, and the Helmert
transformation is recomputed, until all stations pass the criterion.

<p><i>Default value:</i> <tt>50 millimeters</tt>

<p><b>Introduce outliers as predefined elements:</b>
The reference sites rejected as outliers may (<b>TEST</b> or <b> INSR</b>)
or may not (<b>NONE</b>) be reported in the list of predefined elements.
With <b>TEST</b> they will be tested for significance, with <b>INSR</b>
they are inserted permanently without test.

<p><i>Default value:</i> <tt>TEST</tt>

<p><hr>

<p><b>FODITS 5: Statistical tests</b>

<a name="MOD_TEST_VALUE" default="0.1"></a>
<a name="MOD_OUTL_TEST_VALUE" default="50.0"></a>
<p><b>SIGNIFICANCE TEST</b>
<p><b>Threshold for relative improvement:</b>
This threshold is valid for discontinuities, velocity changes, and periodic
functions. It is checked against the relative improvement in the sum of
weighted squared residuals when the element under consideration is added to
the model. The test statistical reads:
<pre>
T<sub>t</sub> = (v<sub>r</sub><sup>T</sup>Pv<sub>r</sub> / v<sub>f</sub><sup>T</sup>Pv<sub>f</sub> - 1) * ( n<sub>obs,series</sub> / n<sub>obs,tot</sub> )
</pre>
where <tt>v</tt><sub>r</sub> is the vector of residuals of the reduced model,
and <tt>v<sub>f</sub></tt> is the vector of residuals of the full model,
including the element under consideration. The normalization obtained by the
number of observations in the analyzed time series n<sub>obs,series</sub>
and the number of observations of the same time series but without data gaps
n<sub>obs,tot</sub> allows it to define an impartial test statistical
T<sub>t</sub> for all analyzed time series.
<br>
The removal of an element from the functional model is tested by:
<pre>
T<sub>t</sub> = (v<sub>f</sub><sup>T</sup>Pv<sub>f</sub> / v<sub>r</sub><sup>T</sup>Pv<sub>r</sub> - 1) * ( n<sub>obs,series</sub> / n<sub>obs,tot</sub> ).
</pre>

<p><i>Default value:</i> <tt>0.1</tt>

<p><i>Remark:</i> The default value for the threshold is rather large. To
detect more subtle events it has to be reduced significantly.

<p><b>N*sigma criterion for outliers:</b>
Sigma-factor for the rejection of outliers. The standard deviation sigma is
taken from ADDNEQ2 (and therefore will be a pessimistic global estimate in
most cases).

<p><i>Default value:</i> <tt>50.0</tt>

<p><i>Remark:</i> The default factor is rather large. To
detect smaller outliers it has to be reduced significantly.

<br><br>

<a name="MOD_JUMP_SPAC" default=""></a>
<a name="MOD_JUMP_SING" default=""></a>
<a name="MOD_JUMP_HORI" default=""></a>
<a name="MOD_JUMP_VERT" default=""></a>
<a name="MOD_VELO_SPAC" default=""></a>
<a name="MOD_VELO_SING" default=""></a>
<a name="MOD_VELO_HORI" default=""></a>
<a name="MOD_VELO_VERT" default=""></a>
<a name="MOD_OUTL_SPAC" default=""></a>
<a name="MOD_OUTL_SING" default=""></a>
<a name="MOD_OUTL_HORI" default=""></a>
<a name="MOD_OUTL_VERT" default=""></a>
<a name="MOD_PERI_SPAC" default=""></a>
<a name="MOD_PERI_SING" default=""></a>
<a name="MOD_PERI_HORI" default=""></a>
<a name="MOD_PERI_VERT" default=""></a>
<p><b>MINIMAL DISPLACEMENT</b>
<p>
Any of the different elements of the functional model is only considered
significant if it leads to a certain minimal displacement of the station.
Minimal values may be defined for horizontal, vertical, or
<nobr>3D-displacement</nobr>, as well as for the change in a single
coordinate. An event passes the test, if at least one criterion is met.
A blank field is considered as zero.

<p><i>Default value:</i> blank

<p><hr>

<p><b>FODITS 6: Identification step</b>

<a name="MOD_NEW_JUMP_IDENTIF" default="1"></a>
<a name="MOD_NEW_VELO_IDENTIF" default="1"></a>
<a name="MOD_NEW_OUTL_IDENTIF" default="1"></a>
<a name="MOD_NEW_PERI_IDENTIF" default="0"></a>
<p><b>SELECTION OF NEW ELEMENTS</b>
<p>
After the predefined elements were tested for significance, the algorithm
searches for any of the following new elements:

<p><b>Discontinuities:</b> <i>Default value:</i> marked

<p><b>Velocity changes:</b> <i>Default value:</i> marked

<p><b>Outliers:</b> <i>Default value:</i> marked

<p><b>Periodic functions:</b> <i>Default value:</i> unmarked

<br><br>

<a name="MOD_ADD_VELO_A_J" default="1"></a>
<p><b>ADDITIONAL ELEMENTS</b>
<p><b>Propose a velocity change after each discontinuity:</b>
In most cases a velocity change takes place together with a discontinuity.
When marked, a new velocity change is proposed after each discontinuity
(in the functional model and/or found by the search).

<p><i>Default value:</i> marked

<br><br>

<a name="SAN_NLINES" default="200"></a>
<a name="SAN_MIN_PER" default="50"></a>
<a name="SAN_MAX_PER" default="5000"></a>
<p><b>SEARCH FOR NEW PERIODIC FUNCTIONS</b>
<p>Periodic functions on a number of periods within a given interval are
automatically proposed as new elements. The shortest and longest period (in days)
as well as the number of new periods (equally spaced within the given interval)
may be chosen.

<p><b>Number of spectral lines:</b> <i>Default value:</i> <tt>200</tt>

<p><b>Minimal period:</b> <i>Default value:</i> <tt>50 days</tt>

<p><b>Maximal period:</b> <i>Default value:</i> <tt>5000 days</tt>

<p><hr>

<p><b>FODITS 7: Options to generate files for ADDNEQ2</b>

<a name="OUT_TIMREF" default=""></a>
<p><b>GENERAL OPTIONS</b>
<p><b>Reference epoch for station coordinates:</b>
This reference epoch is only used for the
<a href="#OUT_STA_FILE_FOR_ADDNEQ2">renaming of stations</a> at
discontinuities. The station names at the reference epoch are kept unchanged,
while characters 15 and 16 of the station names before and after this epoch are
permuted. If no reference epoch is given, it is taken from the ADDNEQ2
reference frame realization.

<p><i>Default value:</i> blank

<br><br>

<a name="MIN_TIME_INT_FIX" default="3.0"></a>
<a name="MIN_PERC_DATA_FIX" default="70.0"></a>
<p><b>REFERENCE SITES</b>
<p><b>Minimal interval length per group:</b>
Discontinuities divide long time series into sub-intervals, but the station
velocities normally stay constant (forced by relative velocity constraints
at discontinuities). The sub-intervals between explicit velocity changes are
grouped. Whenever a new velocity change is introduced, the remaining interval
lengths of the neighbouring groups are checked. If they are smaller than the
'minimal interval length', then the estimated velocities are considered
untrustworthy and the station is removed from the list of reference sites.

<p><i>Default value:</i> <tt>3.0 years</tt>

<p><b>Minimal percent of data per group:</b>
Whenever the amount of data within a group of consecutive sub-intervals with
constant velocity is below a certain percentage, the station names belonging
to the group are removed from the list of reference sites.

<p><i>Default value:</i> <tt>70.0 %</tt>

<br><br>

<a name="IN_CRD_FILE_FOR_ADDNEQ2" default=""></a>
<a name="IN_VEL_FILE_FOR_ADDNEQ2" default=""></a>
<a name="IN_FIX_FILE_FOR_ADDNEQ2" default=""></a>
<a name="IN_SIG_FILE_FOR_ADDNEQ2" default=""></a>
<a name="OUT_CRD_FILE_FOR_ADDNEQ2" default=""></a>
<a name="OUT_VEL_FILE_FOR_ADDNEQ2" default=""></a>
<a name="OUT_FIX_FILE_FOR_ADDNEQ2" default=""></a>
<a name="OUT_SIG_FILE_FOR_ADDNEQ2" default=""></a>
<p><b>UPDATE ADDNEQ2 INPUT FILES</b>
<p>FODITS updates the <a href="/$X/DOC/EXAMPLE.CRD">CRD</a> and
<a href="/$X/DOC/EXAMPLE.VEL">VEL</a> files used by
<a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a> by appending the a priori information
for all renamed stations. The list of reference stations for the datum
definition in the <a href="/$X/DOC/EXAMPLE.FIX">FIX</a> and
<a href="/$X/DOC/EXAMPLE.SIG">SIG</a> files is updated according to the
<a href="#OUT_STA_FILE_FOR_ADDNEQ2">renaming of stations</a>.
Stations that did not pass the tests on group length and amount of data are
removed. In the left column the original files have to be given, in the right
column the names of the updated files are defined.
<br>
The updated files may be used by ADDNEQ2 subsequently for a more consistent
solution (together with the updated <a href="/$X/DOC/EXAMPLE.STA">STA</a> file
given on panel 2).

<br><br>

<a name="UPD_STA_NDAYS" default="1"></a>
<p><b>UPDATE STATION INFORMATION</b>
<p><b>Number of days stacked in consecutive solution:</b>
Whenever <a href="PGMLST.HLP#ADDNEQ2">ADDNEQ2</a> is used to stack daily NEQs
for 3-day or weekly solutions, the middle epoch of the combined solution is
taken as reference epoch. If FODITS is used to update files for a consecutive
stacked solution, this has to be considered. FODITS has to lengthen the
intervals reported, e.g., as outliers, to ensure that the stacked solutions
do not include bad data. For 3-day solutions the interval is lengthened by
2 days, for weekly solutions it is lengthened by 4 days before the start
and after the end of the original interval. Choose 1, 3 or 7 day solution
accordingly.

<p><i>Default value:</i> <tt>1</tt>

<p><hr>

</body>
</html>
